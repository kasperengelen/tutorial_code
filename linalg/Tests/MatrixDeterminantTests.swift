
import XCTest
@testable import LinAlgTutorials

/// Tests for determinants
final class MatrixDeterminantTests: XCTestCase {
    public func testDeterminant2x2() {
        let mat1 = Matrix(rows: [
            [12.695521965890869, 10.769066787157136], 
            [-16.43710346047314, 17.13147349150045]])
        XCTAssertEqual(mat1.determinant(), 394.5052629726679, accuracy: 0.00001)

        let mat2 = Matrix(rows: [
            [-14.994580499474635, -20.22310025552665], 
            [-13.18911567948105, -16.996182011109333]])
        XCTAssertEqual(mat2.determinant(), -11.874189318582184, accuracy: 0.00001)

        let mat3 = Matrix(rows: [
            [17.371958581740166, 5.155028675716878], 
            [4.922033297746136, 13.591918513251692]])
        XCTAssertEqual(mat3.determinant(), 210.74502266588112, accuracy: 0.00001)

        let mat4 = Matrix(rows: [
            [3.5561711106016354, 12.885529551074214], 
            [15.181766340448185, -11.390313264344943]])
        XCTAssertEqual(mat4.determinant(), -236.13100178871517, accuracy: 0.00001)
    }

    public func testDeterminant3x3() {
        let mat1 = Matrix(rows: [
            [-16.09786000487426, -4.538270157631093, 11.5699764144614], 
            [-22.256632271963582, -11.02777376076276, 14.28409599769033], 
            [18.401659427097798, -20.173643656123712, -13.604037029569305]])
        XCTAssertEqual(mat1.determinant(), 670.1522821536114, accuracy: 0.00001)

        let mat2 = Matrix(rows: [
            [20.837617299436232, 24.162637804437338, 9.08046451689831], 
            [1.8676701777978586, 24.974568343451004, 17.11246205108607], 
            [-17.15057504749572, 4.961844206391415, -23.587312954107787]])
        XCTAssertEqual(mat2.determinant(), -16097.83911777846, accuracy: 0.00001)

        let mat3 = Matrix(rows: [
            [11.599285559004834, 11.53579318264677, 0.8188965919817761], 
            [12.420888455357705, -21.806462535445608, 16.062396659941328], 
            [-20.550632485523863, 12.362858563687354, 21.817678446741255]])
        XCTAssertEqual(mat3.determinant(), -14997.152266233004, accuracy: 0.00001)

        let mat4 = Matrix(rows: [
            [4.443837212189212, -24.113286599783663, 20.9340844289038], 
            [22.292155223718915, 18.607677313642178, -15.455200774066535], 
            [-17.89945612552669, 7.423818718384879, 23.13641794142353]])
        XCTAssertEqual(mat4.determinant(), 18625.902747887885, accuracy: 0.00001)
    }

    public func testDeterminant5x5() {
        let mat1 = Matrix(rows: [
            [-8.418821974989715, 6.61800184111096, 2.4938158560905634, 2.0718783223248316, -16.82171718819298], 
            [7.575145526315687, -14.783059600981025, -8.738375854030835, 12.537281006238807, -20.49796418249278], 
            [18.924621283446655, -12.928220813805641, 5.593196527117183, -9.75542502993701, 1.2757205508822196], 
            [8.477614092364668, 8.21176663407585, -19.058536685311484, -3.9024077583175263, 4.845427332773838], 
            [3.1559723453481965, 17.626818448380803, 1.7319351205136613, 4.134682706699227, 10.372198355779062]])
        XCTAssertEqual(mat1.determinant(), 3418971.9487901297, accuracy: 0.00001)

        let mat2 = Matrix(rows: [
            [17.183847402282495, 0.5001210962100373, -18.25935209284561, 1.1867931876174254, 10.093054390216572], 
            [0.9362705587630522, -7.926191764565527, 14.992959941787461, -14.694000652398165, -1.27807693025553], 
            [-9.385682711397859, -23.203334615111267, -13.908044376188572, 6.835911205996226, 1.8306000135064266], 
            [-19.980505368186048, 2.5003268827090572, -19.386028663918893, 0.5230149484749305, -23.877021762490763], 
            [0.6776689344132549, 22.51365261829382, 2.899428821134407, -5.08764583258526, 12.841465715762098]])
        XCTAssertEqual(mat2.determinant(), -6549502.150731553, accuracy: 0.00001)
    }

    public func testCramer2x2() {
        let mat1 = Matrix(rows: [[-0.682722791904605, -0.730677486593081], [-0.730677486593081, 0.6827227919046047]])
        let b1 = [0.86345338, 0.08052696]
        let x1 = mat1.solveWithCramer(b: b1)
        XCTAssertEqual(x1[0], -0.64833854, accuracy: 0.00001)
        XCTAssertEqual(x1[1], -0.57592836, accuracy: 0.00001)


        let mat2 = Matrix(rows: [[-0.8402426755702392, -0.5422105182957687], [-0.5422105182957687, 0.840242675570239]])
        let b2 = [0.380050942271666, 0.40971728388515494]
        let x2 = mat2.solveWithCramer(b: b2)
        XCTAssertEqual(x2[0], -0.5414880414374394, accuracy: 0.00001)
        XCTAssertEqual(x2[1], 0.13819432845111848, accuracy: 0.00001)


        let mat3 = Matrix(rows: [[-0.012688624719055852, -0.9999194961609355], [-0.9999194961609355, 0.012688624719055783]])
        let b3 = [0.2706858289799512, 0.4802920490340796]
        let x3 = mat3.solveWithCramer(b: b3)
        XCTAssertEqual(x3[0], -0.4836880145809533, accuracy: 0.00001)
        XCTAssertEqual(x3[1], -0.2645697921657981, accuracy: 0.00001)
    }
}